# Network Switching - DHCP Snooping

+ **DHCP Snooping**:
	- A network security that protects your network from unauthorized devices acting as a (rogue) DHCP server by blocking specific DHCP traffic from untrusted ports and limiting the rate of DHCP requests per device.
	- AIM: combat DHCP spoofing (MitM) attacks.
	- NOTE: DHCP operates on layer 3 while DHCP snooping works layer 2
	- It works by creating a binding table of trusted IP-to-MAC address assignments and only allowing DHCP server messages from designated 'trusted' ports and dropping or forwarding DHCP messages from 'untrusted' ports.
	- _Static IP Mapping_: Is the alternative to DHCP snooping (suitable for non-DHCP environments) but requires manual and permanent configuration of IP address to specific MAC addresses. It also prevents attackers from modifying ARP entries.
	- _Trusted Ports_: are connected to legitimates DHCP servers and DHCP messages from these ports are not inspected.
	- _Untrusted Ports_: are connected to end-users devices or other network segments and DHCP messages from these ports are inspected.
	- _DHCP Snooping Table_: is a table of valid client info (IP address, MAC addres, VLAN interface) when a device receives a valid DHCPACK from an authorised server.

+ DHCP snooping is manually enabled on Cisco switches.
+ Trusted ports should be manually configuredand the rest unconfigured ports are considered untrusted ports.
+ Trusted ports are connected to servers and routers; end user devices connected to untrusted ports.


### Tasks
1. Create VLAN topology in Packet Tracer
2. Config IP addresses to the router interface & DHCP server
3. Config a simple DHCP server device
4. Enable DHCP snooping on the switch
5. ID and config ports as trused ports
6. Assign IP DHCP snooping to the VLAN currently being used.



#### Step 2 - Basic Config

**Router 0**
! Basic Config
conf t
hostname R0
ban motd ^Unauthorised Access is Prohibited. All Activity is Logged.^
enable password cisco123
service password-encryption
no ip domain-lookup
ip domain-name domain.com
ip add 10.10.10.1 255.255.255.0
no shut

do wr

**Switch 0**
! Basic Config
conf t
hostname SW0
ban motd ^Unauthorised Access is Prohibited. All Activity is Logged.^
enable password cisco123
service password-encryption
no ip domain-lookup
ip domain-name domain.com

do wr

#### Step 3 - DHCP Server configs

**Legitimate DHCP Server**
IPv4 Add: 10.10.10.40/255.255.255.0
Default Gateway 10.10.10.1


**Rogue DHCP Server**
IPv4 Add: 10.10.10.40/255.255.255.0
Default Gateway 10.10.10.1

#### Step 4 - Switch Enable DHCP Snooping
conf t
ip dhcp snooping

#### Step 5 - Config Trusted Ports
int range g0/1,f0/24
ip dhcp snooping trust
exit 

do wr

#### Step 6 - Assign IP DHCP Snooping to VLAN (Default VLAN 1)
! Global Config Mode
ip dhcp snooping vlan 1

do wr
! View configured trusted DHCP VLANS, interfaces/ports
do sh ip dhcp snooping