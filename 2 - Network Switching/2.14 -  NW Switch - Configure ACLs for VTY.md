# Network Switching - Configure ACLs for VTY

+ Access Control Lists (ACL) are a list of _permit_ or _deny_ rules detailing what can or cannot enter or leave an interface (port, VTY, etc).
+ Every packet is verified against each rule in the ACL until a match is found; if no match is found, it will be denied.
+ AIM: Limit administrative access to switches and routers.
+ ACL rules:
	+ _permit_: allows traffic that matches the criteria.
	+ _deny_: block traffic that matches the criteria and discard the packet.
+ Cisco ACLs primarily come in 2 types - Standard ACLs and Extended ACLs.
	+ _Standard ACL_:
		* Focuses on filtering traffic based solely on the source IP address.
		* Use case: used for simple, broad rules, e.g., allowing or denying access from a particular IP address. 
	+ _Extended ACL_:
		* Focuses on providing more granular control by filtering on source & destination IP addresses, protocol types (TCP/UDP), and destination/source port numbers.
		* User case: suitable for complex filtering scenarios, like permitting HTTP traffic from one host to another on a specific port.
+ Both the Standard and Extended ACLs can be configured as either:
	+ _Numbered_: uses a predefined range of numbers to identify the ACL.
	+ _Named_: uses descriptive names, making them easier to manage, understand, and remember, especially in large networks.
+ Advanced ACLs Types include:
	+ _Dynamic_: aka 'lock-and-key' ACLs, require user authentication to grant access to a specific host.
	+ _Reflexive_: allows traffc to return based on the initial connection, creating an association between incoming and outgoing traffic.
	+ _Timed_: allows for schedules to permit or deny traffic based on time.
+ Additional Resources:
	+ [CBT Nuggets - Configure Standard ACLs on Cisco Routers](https://www.cbtnuggets.com/blog/certifications/cisco/networking-basics-how-to-configure-standard-acls-on-cisco-routers)
	+ [Cisco Configure and Filter IP Access Lists](https://www.cisco.com/c/en/us/support/docs/security/ios-firewall/23602-confaccesslists.html)
	+ [Pluralsight - Access Controls Lists in Networking](www.pluralsight.com/resources/blog/tech-operations/access-control-list-concepts)

### Tasks
1. Create VLAN topology in Packet Tracer & Basic Endpoint/Switch/Router Configuration.
2. Config management VLAN & assign it an IP address in the subnet.
3. Config router as default gateway of the switch
4. Config switch domain name, username, and password.
5. Generate cryptographic RSA keys using 1024 modulus (SSH Access).
6. Config line VTY to use local database and only allow SSH.
7. Enable SSH version 2
8. Try SSH from any endpoint (All are able  to connect).
9. Config ACL to permit only VTY interface from SysAdmin PC
10. Try SSH from any endpoint (only SysAdmin PC should work). 


#### Task 1 - Basic Switch, Router, & Endpoint Config

+ SysAdmin PC: 10.10.1.2
+ FIN Dept PCs: 10.10.2.2-5
+ Router (R0): 
	+ G0/1-10.10.1.1  
	+ G0/0-10.10.2.1 (End User)

**Switch 0**
! Basic Config
conf t
hostname SW0
ban motd ^Unauthorised Access is Prohibited. All Activity is Logged.^
enable password cisco123
service password-encryption
no ip domain-lookup

do wr

**Router 0**
! Router Config
conf t
hostname R0
enable password cisco123
service password-encryption
ban motd ^Unauthorised Access is Prohibited. All Activity is Logged.^
int g0/0
description Link to User LAN
ip add 10.10.2.1 255.255.255.0
no sh
exit

int g0/1
description Link to Admin LAN
ip add 10.10.1.1 255.255.255.0
no sh
exit

do wr

!NB: SysAdmin PC should be able to ping the FIN PCs.

#### Task 2 - Config Mgt VLAN and IP Address of Subnet
**Switch 0**
conf t
! Management IP Config
int vlan 1
description management vlan
no sh
ip add 10.10.2.254 255.255.255.0
exit


#### Task 3 - Config router as default gateway of the switch
**Switch 0**
conf t
ip default-gateway 10.10.2.1

do wr


#### Task 4 - Config switch domain name, username, and password
**Switch 0**
conf t
! Switch Config Domain name
ip domain-name cisco.com
username admin password password123


#### Step 5 (& 7) - Config SSH Secure Access
**Switch 0**
! Global Config Mode
! Enable SSH with 1024-bit keys, set domain (for key generation), and force SSHv2
! Timeout authentication process (default 120)

crypto key generate rsa general-keys modulus 1024 
ip ssh version 2 
ip ssh time-out 60


#### Step 6 - Config SSH on VTY 0 - 15
**Switch 0**
line vty 0 15
! Specify authentication based on local db
login local
! Only permit SSH (no telnet)
transport input ssh


#### Step 8 - Try SSH connect from any endpoint
+ All should be able to access the switch 
+ User the Telnet/SSH Client OR CMD with command: `ssh -l <username> 10.10.2.254`


#### Step 9 - Config ACL to permit only VTY interface from SysAdmin PC
**Switch 0**
conf t
! Create Standard Numbered ACL list to allow SysAdmin PC
access-list 10 permit host 10.10.1.2
access-list 10 deny any
! Bind the ACL to VTY 
line vty 0 15
! Allow incoming traffic on access-list 10
access-class 10 in
exit

do wr

#### Step 10 - Try SSH connect from any endpoint
+ Only SysAdmin PC should work
+ All other PCs return `% Connection refused by remote host`