# Network Switching - Configure Port Security

+ A security feature that restricts network access to a switch port by limiting the specific MAC addresses allowed to connect to each specific port.
+ AIM: Prevent unauthorised devices from joining the network.
+ By default Cisco switches are turned on allowing any device to connect to these interfaces.
+ Switches learn MAC addresses when the frame is forwarded through a switch port.

+ Cisco port security MAC address management is offered in one of three types:
	1. _Static_: 
		+ Manually configured by an admin via `switchport security mac-address <mac-address>`. 
		+ Addresses are stored in the MAC address table.
		+ MAC Addresses are saved to the startup config and persist after reload.
	2. _Dynamic_: 
		+ Switch automatically learns the MAC addresses when devices are connected to the port. 
		+ MAC addresses are only stored in the table (not saved) and do not persiste on switch reload. 
	3. _Sticky_: 
		+ The switch learns the MAC addresses dynamically and automatically convert them to static (sticky) saving them to the startup configuration that persiste after reload/reboot.

+ Port security violation occurs:
	+ The maximum number of secure MAC addresses has been added to a a switchport's address table and traffic form another MAC address is received on the switchport.
	+ An address that has been on a secure switchport has already been seen on another secure switchport in the same VLAN.

+ Cisco port security has 3 violation modes:
	1. _Protect_: 
		+ Action - Packets with unknown or unauthorised source MAC addresses are dropped. 
		+ Notification - No violation message is sent to the system log or console.
		+ Port Status - Port remains active, but traffic from MAC addresses not in the security table is ignored.
	2. _Restrict_:
		+ Action - Packets with unknown or unauthorised source MAC addresses are dropped (same as Protect mode).
		+ Notification - Notification (syslog message) is sent to the system log when a violation occurs.
		+ Port Status - Port remains active, but the security count increments.
	3. _Shutdown_ (Default):
		+ Action - When a security violation is detected, the port is immediately set to an err-disabled state, becoming inactive (port's LED turns off).
		+ Notification - Port's status changes to 'Secure-shutdown'. 
		+ Port Status - Port is disabled (default mode) and requires manual intervention to re-enable the port (`shutdown` & `no shutdown`).

+ Configuration Commands:
`SW1(config)# int f0/3`
`SW1(config)# switchport mode access`
`SW1(config)# switchport port-security`
`SW1(config)# switchport port-security maximum 1`
! Define the mac address permitted to access the port/interface
`SW1(config)# switchport port-security mac-address <mac-address>`
`SW1(config)# switchport port-security violation <shutdown | restrict | protect >` 
`SW1(config)# switchport port-security mac-address sticky`

### Tasks
1. Create VLAN topology in Packet Tracer & Basic Endpoint/Switch Configuration
2. ID Ports to configure port-security, max number of device per port, violation mode, and method of obtaining the MAC addresses.
3. Configure the following:
	+ Port Security Violation Mode = shutdown, 1 Device per Port, and MAC Address management = sticky
	+ Port Security Violation Mode = restrict, 2 Device per Port, and MAC Address management = sticky
	+ Port Security Violation Mode = protect, 1 Device per Port, and MAC Address management = static/manual
4. Ping test toi create trusted MAC-ports table combinations, Replace authorised PCs and connect hacker laptop to an interface with port security


#### Task 1 - Basic Switch + Endpoint Config
**Switch 0**
! Basic Config
conf t
hostname SW0
ban motd ^Unauthorised Access is Prohibited. All Activity is Logged.^
enable password cisco123
service password-encryption
no ip domain-lookup
ip domain-name domain.com

do wr

! Disable Unused ports
vlan 999
name blackhole
int range f0/6-24,g0/1-2
switchport mode access
switchport access vlan 999
shutdown
exit

do wr
do sh ip int br

#### Task 3 - A
int range f0/1-2
switchport mode access
switchport port-security
switchport port-security maximum 1
! Define the mac address permitted to access the port/interface
switchport port-security mac-address sticky
switchport port-security violation shutdown

do wr
exit
do sh port-security

#### Task 3 - B
int range f0/3-4
switchport mode access
switchport port-security
switchport port-security maximum 2
switchport port-security mac-address sticky
switchport port-security violation restrict

do wr
exit
do sh port-security

#### Task 3 - C
int f0/5
switchport mode access
switchport port-security
switchport port-security maximum 1
! Define the mac address permitted to access the port/interface
switchport port-security mac-address 0002.1734.0243
switchport port-security violation protect

do wr
exit
do sh port-security


#### Task 4 - Ping Test to Create MAC-Interface Table
! View Table
do sh mac-address-table