# Cisco Switch Secure Configuration

## Secure Router Configuration Baseline
### Basic Identify & Access Control
! Access Global Config
`en`
`config t`
! Configure hostname (Descriptive Name) - amend accordingly
`hostname R1` or `hostname R-dept` or `hostname R-fl3`
! Secure Privilege EXEC mode with encrypted password
`en sec <StrongPassword>`
! Encrypt all plaintext passwords
`ser pass-encr`
! Disable DNS lookups
`no ip dom-lookup`
! Legal Banner
`ban motd ^Unauthorised Access is Prohibited. All Activity is Logged.^`

### User Authentication
! Global Config Mode: create local user with encrypted password
`username admin sec <StrongPassword>`
`line con 0`

! Line Config Mode: login via local user account, set timeout to 5 minutes, & synchronise logs with prompts
`login local`
`exec-timeout 5 0`
`logg syn`

! Line Config Mode
! Secure remote access: disable Telnet, enforce SSH only, and apply timeouts
`line vty 0 15`
`login local`
`transport input ssh`
`exec-timeout 5 0`
`logg syn`

### SSH Secure Access
! Global Config Mode
`config t`
! Enable SSH with 2048-bit keys, set domain (for key generation), and force SSHv2
`crypto key generate rsa modulus 2048`
`ip dom-name domain.com`
`ip ssh version 2`
! Timeout authentication process (default 120)
`ip ssh time-out 60`

### Interface Security
! Global and Interface Config Mode
`en`
`conf t`
`int g0/0`
! Assign IP to LAN interface
`description Link to LAN`
`ip add 192.168.1.1 255.255.255.0`
`no sh`
! Config WAN interface
`int g0/1`
`description WAN/ISP Link`
`ip add dhcp`
`no shut`
`exit`
! Disable Cisco Discovery Protocol and HTTP and HTTPS server (attack surface reduction)
`no cdp run`
`no ip http server`
`no ip https secure-server`
! Restrict SSH access to trusted IPs only
`ip access-list standard MGMT-ACCESS`
`permit 192.168.1.0 0.0.0.255`
`deny any log`
`line vty 0 4`
`access-class MGMT-ACCESS`

### Secure Routing and ACLs
! Global Config Mode
`en`
`conf t`
! Prevent attackers from specifying source routes
`no ip source-route`
! Prevent Smurf/DOS amplification attacks
`no ip directed-broadcast`
! Enable Cisco Express Forwarding for performance and security
`ip cef`
! Block private IP spoofing on WAN interface
`ip access-list extended INTERNET-IN`
`deny ip 10.0.0.0 0.255.255.255 any log`
`deny ip 172.16.0.0 0.15.255.255 any log`
`deny ip 192.168.0.0 0.0.255.255 any log`
`permit ip any any`
`int g0/1`
`ip access-group INTERNET-IN in`

### Security Hardening
! Block brute-force login attempts
`login block-for 120 attempts 3 within 60`
! Enforce Strong Password Policy
`security passwords min-length 10`
! Ensure idle TCP sessions are automatically closed (resource mgt & prevent session hijack/exploit)
`service tcp-keepalives-in`
`service tcp-keepalives-out`

### Logging and Monitoring
! User EXEC Mode
`en`
! Show current clock settings
`sh clock`
! Set the correct date/time before proceeding
! Store logs in buffer and timestamp with precision
`logging buffered 16384 warnings`
`ser timestamps log datetime msec`
! Enable config change logging
`conf t`
! Archive config mode
`R1(config)#` `archive`
! Configuration Change Logger Mode
`R1(config-archive)#` `log config`
! Enable config change logging
`R1(config-log-config)#` `logging enable` 
! Send config changes to IOS syslog process
`R1(config-log-config)#` `notify syslog`
! Suppress password info from displaying in config log file
`R1(config-log-config)#` `hidekeys`
! Verify config change logging
`R1#` `sh archive log config all` 

### Save Config
`en`
`wr`



## Secure Basic Router Configuration

+ The commands below can be copied and pasted directly into a router's CLI to provide secure remote SSH access.
+ In addition, the physical Console line is secured and only remote SSH access is permitted.
+ **NB**: Replace the various variables below with the suitable strong passwords.
+ Additional Security:
	+ Apply ACL to limit SSH access to specific IP/VLAN.

! Configuration Starts Here
en
conf t
hostname R1
ban motd ^Unauthorised Access is Prohibited. All Activity is Logged.^

! Secure Priveleged Exec Mode 
enable password <password>

! Disable domain lookup (prevent DNS lookups)
no ip domain-lookup

! Set IP Domain Name
ip domain-name [domain.com]

!Set Username and Password (Remote Access - Local DB)
username admin password <password>

! Encrypt all passwords
service password-encryption

! Set Clock Time (return to priv exec mode R1#)
exit
clock set [15:30:00 22 August 2025]

! Prevent Brute-force attack (Global config mode required)
conf t
login block-for 120 attempts 3 within 50

! Enable Line Console Password
line con 0
! Specify authentication based on local db
login local
exec-timeout 3 0
logg syn
exit


! Config SSH Access
! Enable SSH with 1024-bit keys, set domain (for key generation), and force SSHv2
! Timeout authentication process (default 120)
crypto key generate rsa general-keys modulus 1024 
ip ssh version 2 
ip ssh time-out 60

! Config VTY SSH Access
line vty 0 15
! Specify authentication based on local db
login local
! Only permit SSH (no Telnet)
transport input ssh
exit

! Copy Running Config to Startup Config
do wr