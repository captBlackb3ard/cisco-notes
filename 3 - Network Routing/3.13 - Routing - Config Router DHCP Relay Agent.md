# Routing - Configure Router DHCP Relay Agent

## DHCP Relay Agent

+ It is a network device (router or switch) that forwards DHCP broadcast packets from DHCP clients to DHCP servers on a different subnet, enableing clients to obtain IP addresses and other network configuration details from a remote server.
+ Standard routers do not forward IP broadcasts, thus a DHCP Relay Agent is required to bring the gap between clients on one network segment and a DHCP server located on a separate network segment.
+ Benefits:
	+ _Cost Reduction_: It reduces the need to deploy DHCP servers on every subnet/segment.
	+ _Centralised Management_: Allows for the management of all client IPs from a single DHCP server (Single-Point-of-Failure).
	+ _Network Segmentation_: Enables a more structured and scalable network architecture by allowing DHCP clients and servers to exist on different subnets/segments.

## Tasks
1. Create VLAN topology in Packet Tracer & Basic Router/Switch/PC(enable DHCP)/Server Configuration.
2. Config Router Interface IP & DHCP Static IP
3. DHCP Server Config: Create DHCP Pools, Subnet Mask, Default Gateway, and DNS Server
4. Config Router Office LAN Interface (Gig0/0) to relay DHCP messages.
5. Test DHCP Relay Requests & Communication.




### Task 1 + 2 - Config Router, Switch, DHCP Server, & PCs
**Switch 0 - Office Network**
! Basic Config
conf t
hostname SW-Office
ban motd ^Unauthorised Access is Prohibited. All Activity is Logged.^
enable password cisco123
service password-encryption
no ip domain-lookup
ip domain-name cybersec.com

vlan 20
name Office
exit
vlan 999
name blackhole
exit

! Secure Unused Ports
int range f0/5-24, g0/2
switchport mode access
switchport access vlan 999
shutdown
exit

! Configure Trunk to Router + Server Switch
int range g0/1
switchport mode trunk
! Security - Deny VLAN 999 on trunk link
switchport trunk allowed vlan except 999
exit
do sh int trunk

! Additional Security - Port Security
int range f0/1-4
switchport mode access
switchport port-security
switchport port-security maximum 1
! Define the mac address permitted to access the port/interface
switchport port-security mac-address sticky
switchport port-security violation restrict
exit

do sh port-security

do wr

**Router 0**
! Router Config
conf t
hostname R0
enable password cisco123
service password-encryption
ban motd ^Unauthorised Access is Prohibited. All Activity is Logged.^
ip domain-name cybersec.com
username admin password password123
int g0/0
description Link to Office Network
ip add 10.10.20.1 255.255.255.0
no sh
exit
int g0/1
description Link to DHCP Server
ip add 10.10.10.1 255.255.255.0
no sh
exit

! Config SSH Access
! Enable SSH with 1024-bit keys, set domain (for key generation), and force SSHv2
! Timeout authentication process (default 120)
crypto key generate rsa general-keys modulus 1024 
ip ssh version 2 
ip ssh time-out 60

! Config VTY SSH Access
line vty 0 15
! Specify authentication based on local db
login local
! Only permit SSH (no Telnet)
transport input ssh
exit

! Create Standard Numbered ACL list to allow IT Admin PC
access-list 10 permit host 10.10.20.2
access-list 10 deny any
! Bind the ACL to VTY 
line vty 0 15
! Allow incoming traffic on access-list 10
access-class 10 in
exit

do sh ip int br

do wr


### Task 3 - DHCP Server: Define IP Pools, Subnet Mask, Default Gateway, & DNS Server.

+ Start IP Add: 10.10.20.5
+ DNS Server: 10.10.10.2
+ Default Gateway: 10.10.10.1 (Gateway on Server Side)


### Task 4 - Config Router to Relay DHCP Messages

**Router 0**
int g0/0
ip helper-address 10.10.10.2
exit

do wr

! View DHCP Relay Config in Startup Config
do sh running-config | include ip helper-address